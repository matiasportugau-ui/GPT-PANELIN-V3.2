version: '3.8'

services:
  panelin-gpt:
    build:
      context: .
      dockerfile: Dockerfile.boot
    image: panelin-gpt:boot
    container_name: panelin-gpt-boot
    
    environment:
      # BOOT configuration
      - PANELIN_ROOT=/app
      - GENERATE_EMBEDDINGS=0
      - PYTHON_BIN=python3
      - BOOT_LOG_MAX_SIZE_MB=10
      
      # Optional: API key for embeddings (only if GENERATE_EMBEDDINGS=1)
      # - PANELIN_API_KEY=${PANELIN_API_KEY}
    
    volumes:
      # Persist BOOT artifacts across container restarts
      - boot-data:/app/.boot-data
      
      # Optional: Mount custom knowledge base
      # - ./custom-knowledge:/app/knowledge:ro
    
    ports:
      - "8000:8000"
    
    restart: unless-stopped
    
    healthcheck:
      test: ["CMD", "test", "-f", "/app/.boot-ready"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s

volumes:
  boot-data:
    driver: local

# Usage:
#   docker-compose -f docker-compose.boot.yml up -d
#   docker-compose -f docker-compose.boot.yml logs -f
#   docker-compose -f docker-compose.boot.yml down
